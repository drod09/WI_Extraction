import os

# === SETTINGS ===
target_folder = r"C:\Users\U309011\Desktop\CurrentPP"
recursive = False  # set to True if you want to include subfolders

def iter_files(root):
    if recursive:
        for r, _, files in os.walk(root):
            for f in files:
                yield r, f
    else:
        for f in os.listdir(root):
            p = os.path.join(root, f)
            if os.path.isfile(p):
                yield root, f

# Map base names ‚Üí available extensions
files_by_stem = {}
for root, fname in iter_files(target_folder):
    stem, ext = os.path.splitext(fname)
    files_by_stem.setdefault((root, stem.lower()), set()).add(ext.lower())

deleted = []

# Delete .ppt if a matching .pptx exists
for (root, stem), exts in files_by_stem.items():
    if ".ppt" in exts and ".pptx" in exts:
        ppt_path = os.path.join(root, stem + ".ppt")
        try:
            os.remove(ppt_path)
            deleted.append(ppt_path)
            print(f"üóëÔ∏è Deleted: {ppt_path}")
        except Exception as e:
            print(f"‚ùå Failed to delete {ppt_path}: {e}")

print(f"\n‚úÖ Completed. Deleted {len(deleted)} duplicate .ppt files.")