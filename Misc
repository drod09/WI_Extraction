private static DataTable SortByRowOrder(DataTable dt)
{
    if (dt == null || dt.Columns.Count == 0) return dt;
    if (!dt.Columns.Contains("RowOrder")) return dt;

    var sortedRows = dt.AsEnumerable()
                       .OrderBy(r => SafeInt(r["RowOrder"]));

    return sortedRows.CopyToDataTableOrEmpty();
}