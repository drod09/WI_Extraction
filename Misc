private static A.Table BuildTable(int rows, int cols, DataTable dt)
{
    var table = new A.Table();

    // Style
    table.Append(
        new A.TableProperties(
            new A.TableStyleId("{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}"))
    );

    // Grid: create a NEW GridColumn per column (no Enumerable.Repeat!)
    var grid = new A.TableGrid();
    long colWidth = 24000000L / Math.Max(cols, 1); // simple width split
    for (int c = 0; c < cols; c++)
        grid.Append(new A.GridColumn() { Width = colWidth });
    table.Append(grid);

    // Header row
    var headerRow = new A.TableRow() { Height = 370840L };
    foreach (DataColumn col in dt.Columns)
        headerRow.Append(MakeCell(col.ColumnName, bold: true));
    table.Append(headerRow);

    // Data rows
    foreach (DataRow dr in dt.Rows)
    {
        var row = new A.TableRow() { Height = 370840L };
        foreach (DataColumn col in dt.Columns)
            row.Append(MakeCell(dr[col]?.ToString() ?? ""));
        table.Append(row);
    }

    return table;
}