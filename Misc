import pandas as pd
import shutil
from pathlib import Path

# Read Excel file
excel_path = r"C:\path\to\your\excel\file.xlsx"
df = pd.read_excel(excel_path)

# Create destination folder
dest_folder = Path.home() / "Desktop" / "Current WI"
dest_folder.mkdir(exist_ok=True)

# Copy files from 'Displayed Rev Full Path' column
success = 0
failed = 0
not_found = 0

for file_path in df['Displayed Rev Full Path']:
    # Skip empty cells
    if pd.isna(file_path):
        continue
    
    source = Path(str(file_path).strip())
    
    if source.exists():
        try:
            shutil.copy2(source, dest_folder)
            print(f"✓ Copied: {source.name}")
            success += 1
        except Exception as e:
            print(f"✗ Failed to copy {source.name}: {e}")
            failed += 1
    else:
        print(f"⚠ File not found: {file_path}")
        not_found += 1

print(f"\n{'='*50}")
print(f"Complete!")
print(f"  ✓ Successfully copied: {success} files")
print(f"  ✗ Failed to copy: {failed} files")
print(f"  ⚠ Files not found: {not_found}")
print(f"{'='*50}")