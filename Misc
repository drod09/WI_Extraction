import os
import win32com.client

# === Folder containing your PPT/PPTX files ===
source_folder = r"C:\Users\U309011\Desktop\CurrentPP"

# Launch PowerPoint application (invisible)
ppt_app = win32com.client.Dispatch("PowerPoint.Application")
ppt_app.Visible = True

converted = []
skipped = []

for file_name in os.listdir(source_folder):
    if file_name.lower().endswith(".ppt") and not file_name.lower().endswith(".pptx"):
        full_path = os.path.join(source_folder, file_name)
        new_path = os.path.splitext(full_path)[0] + ".pptx"

        try:
            presentation = ppt_app.Presentations.Open(full_path, WithWindow=False)
            presentation.SaveAs(new_path, 24)  # 24 = ppSaveAsOpenXMLPresentation
            presentation.Close()
            converted.append(file_name)
            print(f"Converted: {file_name} → {os.path.basename(new_path)}")
        except Exception as e:
            skipped.append((file_name, str(e)))
            print(f"❌ Failed to convert {file_name}: {e}")

ppt_app.Quit()

print(f"\n✅ Conversion complete: {len(converted)} converted, {len(skipped)} skipped.")
if skipped:
    print("Skipped files:")
    for name, err in skipped:
        print(f" - {name}: {err}")